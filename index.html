<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title> ‡§°‡§æ‡§Ø‡§®‡§æ‡§∏‡•ã‡§∞ Real Dily ü™ô Coin Wallet</title>
  <style>
    :root {
      --primary-color: #3498db;
      --secondary-color: #2ecc71;
      --accent-color: #ffd700;
      --danger-color: #e74c3c;
      --background-color: #f5f5f5;
      --card-color: #ffffff;
      --text-color: #333333;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }


body {
      font-family: sans-serif;
      background: #ffffff;
      padding: 20px;
      text-align: center;
    }
    .container {
      background: white;
      padding: 100px;
      max-width: 1000px;
      margin: auto;
      border-radius: 12px;
      box-shadow: 0 0 100px rgba(0,0,0,0.2);
      position: relative;
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
    }
    .balance {
      font-size: 20px;
      margin: 15px 0;
      color: green;
    }
    .box {
      background: #007bff;
      color: white;
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
      cursor: pointer;
    }
    .box:disabled {
      background: #aaa;
      cursor: not-allowed;
    }
    .hidden {
      display: none;
    }


    
    .timer-box {
      position: absolute;
      top: -25px;
      left: 50%;
      transform: translateX(-50%);
      background: #ffd700;
      color: #000;
      padding: 8px 14px;
      border-radius: 8px;
      font-weight: bold;
      box-shadow: 0 0 5px #999;
    }
    .notify {
      background: #28a745;
      color: #fff;
      padding: 8px;
      border-radius: 8px;
      margin-top: 10px;
      display: none;
    }

#withdrawSection {
  background: #f9f9f9;
  padding: 10px;
  margin: 1px 0;
  border: 1px dashed #aaa;
  border-radius: 10px;
}

  .home-btn {
    position: fixed;
    top: 45px;
    left: 45px;
    width: 66px;
    height: 66px;
    background: #007bff;
    color: white;
    border-radius: 25%;
    font-size: 40px;
    text-align: center;
    line-height: 60px;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(0,0,0,0.3);
    z-index: 1000;
  }

  .home-menu {
    position: fixed;
    top: 105px;
    left: 20px;
    background: #007bff;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.2);
    padding: 10px;
    width: 85%;
    max-width: 260px;
    display: none;
    z-index: 999;
  }

  .home-menu input,
  .home-menu button,
  .home-menu a.menu-item {
    width: 100%;
    margin: 8px 0;
    padding: 10px;
    font-size: 16px;
    border-radius: 6px;
    border: none;
    box-sizing: border-box;
  }

  .home-menu button,
  .home-menu a.menu-item {
    background-color: green;
    color: white;
    text-decoration: none;
    text-align: center;
    transition: background-color 0.3s ease;
  }

  .home-menu button:hover,
  .home-menu a.menu-item:hover {
    background-color: darkgreen;
  }

  @media (max-width: 480px) {
    .home-btn {
      width: 50px;
      height: 50px;
      font-size: 28px;
      line-height: 50px;
    }

    .home-menu {
      top: 80px;
      left: 10px;
      width: 90%;
    }

    .home-menu input,
    .home-menu button,
    .home-menu a.menu-item {
      font-size: 15px;
    }
  }


/* History Modal Styling */
.history-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.7);
  z-index: 2000;
}

.history-content {
  position: relative;
  background-color: white;
  margin: 10% auto;
  padding: 20px;
  width: 80%;
  max-width: 600px;
  border-radius: 10px;
  max-height: 70vh;
  overflow-y: auto;
}

.history-close {
  position: absolute;
  top: 10px;
  right: 15px;
  font-size: 24px;
  font-weight: bold;
  cursor: pointer;
}

.history-item {
  padding: 10px;
  margin: 5px 0;
  border-bottom: 1px solid #eee;
  text-align: left;
}

.history-date {
  font-weight: bold;
  color: #007bff;
}

.history-amount {
  color: green;
  font-weight: bold;
}

.history-source {
  color: #666;
  font-style: italic;
}

/* No Internet Modal */
.no-internet-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(255, 0, 0, 0.9);
  z-index: 3000;
  color: white;
  text-align: center;
  padding-top: 20%;
}

.no-internet-content {
  font-size: 24px;
}

.no-internet-content h2 {
  font-size: 36px;
  margin-bottom: 20px;
}

/* Inactive User Modal */
.inactive-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.8);
  z-index: 3500;
  color: white;
  text-align: center;
  padding-top: 20%;
}

.inactive-content {
  font-size: 24px;
  background: rgba(255, 0, 0, 0.8);
  padding: 20px;
  border-radius: 10px;
  margin: 0 auto;
  max-width: 80%;
}

.resume-btn {
  background: #ffd700;
  color: black;
  padding: 15px 30px;
  border: none;
  border-radius: 8px;
  font-size: 18px;
  font-weight: bold;
  margin-top: 20px;
  cursor: pointer;
}

#loginButton {
    background-color: darkblue;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  #loginButton:hover {
    background-color: #007bff; /* ‡§•‡•ã‡§°‡§º‡§æ ‡§î‡§∞ ‡§ó‡§π‡§∞‡§æ ‡§®‡•Ä‡§≤‡§æ */
  }
body { 
  margin: 0; 
  font-family: sans-serif; 
  overflow: hidden; 
  background-color: #ddf3ff; 
  user-select: none; 
  transition: background-color 2s; 
  touch-action: manipulation; 
}

#game {
  width: 75.4vw;
  height: 450px;
  background: #fff;
  border-bottom: 3px solid #000;
  position: relative;
  overflow: hidden;
}

#dino {
  width: 60px;
  height: 60px;
  font-size: 50px;
  position: absolute;
  left: 50px;
  bottom: 0;
  transition: bottom 0.1s ease-out;
  z-index: 10;
}

.obstacle {
  width: 45px;
  height: 45px;
  font-size: 35px;
  position: absolute;
  bottom: 0;
  right: -45px;
  animation: move linear forwards;
  z-index: 5;
  transition: transform 0.5s;
}

@keyframes move {
  0% { right: -45px; }
  100% { right: 100%; }
}

#sky {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  font-size: 30px;
  pointer-events: none;
  z-index: 1;
}

#ground {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 3px;
  background: #000;
  z-index: 2;
}

#score {
  position: relative;
  font-size: 18px;
  padding: 10px;
  background: rgba(255,255,255,0.8);
  display: inline-block;
  border-radius: 10px;
  margin: 10px;
  z-index: 99;
}

#lives {
  position: fixed;
  top: 650px;
  left: 110px;
  font-size: 22px;
  padding: 10px;
  background: rgba(255,255,255,0.8);
  border-radius: 10px;
  z-index: 99;
}

#magnet-timer {
  position: fixed;
  top: 50px;
  right: 10px;
  padding: 5px 10px;
  background: rgba(255,255,255,0.8);
  border-radius: 10px;
  font-size: 16px;
  display: none;
  z-index: 99;
}

#restart-btn {
  position: fixed;
  bottom: 80px;
  left: 50%;
  transform: translateX(-50%);
  padding: 10px 20px;
  background: #4CAF50;
  color: white;
  border: none;
  border-radius: 20px;
  font-size: 18px;
  display: none;
  z-index: 100;
}

#fly-btn {
  position: fixed;
  bottom: 100px;
  right: 10px;
  width: 60px;
  height: 60px;
  background: #2196F3;
  color: white;
  border: none;
  border-radius: 50%;
  font-size: 24px;
  z-index: 100;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

#eaten-items {
  position: fixed;
  bottom: 10px;
  left: 20px;
  right: 20px;
  max-height: 250px;
  background: rgba(255,255,255,0.9);
  border-radius: 10px;
  padding: 10px;
  overflow-y: auto;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  font-size: 26px;
  line-height: 1.5;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

#eaten-items span {
  background: #e0f7e9;
  padding: 5px 10px;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.jump {
  animation: jump 0.5s ease-out;
}

@keyframes jump {
  0% { transform: scale(1); }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

.cloud {
  position: absolute;
  font-size: 40px;
  opacity: 0.7;
  animation: cloudMove linear infinite;
}

@keyframes cloudMove {
  0% { transform: translateX(100vw); }
  100% { transform: translateX(-100px); }
}

@keyframes hueRotate {
  0% { filter: hue-rotate(0deg); }
  50% { filter: hue-rotate(180deg); }
  100% { filter: hue-rotate(360deg); }
}

.magnetized {
  animation: hueRotate 1s infinite;
  filter: saturate(1.5) brightness(1.2);
}

.immune {
  animation: pulse 1s infinite alternate;
  filter: drop-shadow(0 0 10px gold);
}

@keyframes pulse {
  0% { opacity: 0.8; }
  100% { opacity: 1; }
}

@keyframes heartBeat {
  0% { transform: scale(1); }
  50% { transform: scale(1.3); }
  100% { transform: scale(1); }
}

.heart-lost {
  animation: heartBeat 0.5s;
  color: red;
}

/* ‡§Æ‡•ç‡§Ø‡•Ç‡§ü ‡§¨‡§ü‡§® ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
#mute-btn {
  position: fixed;
  top: 10px;
  right: 50px;
  width: 70px;
  height: 70px;
  background: rgba(255,255,255,0.8);
  border: none;
  border-radius: 50%;
  font-size: 70px;
  z-index: 1000;
  cursor: pointer;
}
#start-btn {
  position: fixed;
  top: 66%;
  left: 50%;
  transform: translate(-50%, -50%);
  padding: 15px 10px;
  font-size: 20px;
  background: #ff9800;
  color: white;
  border: none;
  border-radius: 20px;
  z-index: 1000;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}

#power-indicator {
  position: fixed;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(255,255,255,0.8);
  padding: 5px 10px;
  border-radius: 10px;
  font-size: 16px;
  display: none;
  z-index: 100;
}

#immunity-indicator {
  position: fixed;
  top: 10px;
  left: 10%;
  transform: translateX(-50%);
  background: rgba(255,220,50,0.8);
  padding: 5px 10px;
  border-radius: 10px;
  font-size: 16px;
  display: none;
  z-index: 100;
}

/* ‡§ï‡§æ‡§â‡§Ç‡§ü‡§°‡§æ‡§â‡§® ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
#countdown {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 150px;
  color: #ff5722;
  font-weight: bold;
  text-shadow: 0 0 20px rgba(255,255,255,0.8);
  z-index: 1001;
  display: none;
  animation: scale-in 0.5s ease-out;
}

@keyframes scale-in {
  0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0.5; }
  50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
  100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
}

/* ‡§®‡§Ø‡•Ä ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ - ‡§ü‡•ç‡§∞‡•á‡§® ‡§î‡§∞ ‡§¨‡•ã‡§ó‡§ø‡§Ø‡§æ‡§Ç */
.train-car {
  position: absolute;
  font-size: 35px;
  bottom: 0;
  animation: move linear forwards;
  z-index: 5;
}

.special-effect {
  animation: specialEffect 0.8s infinite alternate;
}

@keyframes specialEffect {
  0% { transform: scale(1) rotate(0deg); }
  100% { transform: scale(1.1) rotate(5deg); }
}

/* ‡§∏‡•Å‡§ß‡§æ‡§∞‡§ø‡§§ ‡§≤‡§ø‡§Ç‡§ï */
#eaten-items a {
  text-decoration: none;
}
.train-car {
  width: 40px;
  height: 40px;
  animation: move linear forwards;
  font-size: 30px;
  z-index: 4; /* ‡§°‡§æ‡§Ø‡§®‡§æ‡§∏‡•ã‡§∞ ‡§ï‡•á ‡§™‡•Ä‡§õ‡•á ‡§¶‡§ø‡§ñ‡•á */
}


  </style>
</head>
<body>

<!-- No Internet Modal -->
<div id="noInternetModal" class="no-internet-overlay">
  <div class="no-internet-content">
    <h2>‚ö†Ô∏è ‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§®‡§π‡•Ä‡§Ç!</h2>
    <p>‡§ï‡•É‡§™‡§Ø‡§æ ‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§ö‡§æ‡§≤‡•Ç ‡§ï‡§∞‡•á‡§Ç</p>

<h2 style="font-size: 300px;">ü¶ï</h2>

   <h2>  üß± ‡§°‡§æ‡§Ø‡§®‡§æ‡§∏‡•ã‡§∞ Real Dily Coin Wallet üß±</h2>
 
  </div>
</div>

<!-- Inactive User Modal -->
<div id="inactiveModal" class="inactive-modal">
  <div class="inactive-content">
    <h2>‚ö†Ô∏è Welcome !</h2>
    <p>  ‡§Ü‡§™ ‡§ó‡•á‡§Æ ‡§∏‡•á ‡§¨‡§æ‡§π‡§∞ ‡§ö‡§≤‡•á ‡§ó‡§è ‡§•‡•á   </p>
    <button class="resume-btn" onclick="resumeGame()">ü¶ï ‡§ó‡•á‡§Æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
  </div>
</div>

<!-- History Modal -->
<div id="historyModal" class="history-modal">
  <div class="history-content">
    <span class="history-close" onclick="closeHistory()">&times;</span>
    <h2>Coine History</h2>
    <div id="historyList">
      <!-- History items will be added here -->
    </div>
  </div>
</div>

<div class="home-btn" onclick="toggleMenu()">&#9776;</div>

<div class="home-menu" id="homeMenu">
 <input type="text" id="inviteUser" placeholder="Enter friend's username" />
<button onclick="claimReferral()">Claim Invite Bonus</button>

</button>
<button id="button1" onclick="myFunction()"> 
 <a href="https://thask-for-coin.vercel.app/" class="menu-item"> Daily Task Coin </a>



<button onclick="showHistory()">Coin History</button>
<button onclick="shareApp()">Share App</button>

<button id="button1" onclick="myFunction()"> 
 <a href="#" class="menu-item">Download App </a>
 </button>
<button id="button1" onclick="myFunction()"> 
 <a href="#" class="menu-item">‡§ñ‡•á‡§≤ ‡§ï‡•á ‡§®‡§ø‡§Ø‡§Æ ‡§î‡§∞ ‡§ï‡§æ‡§®‡•Ç‡§® </a>
 </button>
<button id="button1" onclick="myFunction()"> 
 <a href="#" class="menu-item">‡§®‡§Ø‡§æ game </a>
 </button>
<button id="button1" onclick="myFunction()"> 
 <a href="#" class="menu-item">Help</a>
 </button>
 
<button onclick="logout()">Logout</button>
</div>





  <div class="container">
    <!-- Time Box -->
    <div class="timer-box" id="timerBox">
      Time Spent: <span id="timeElapsed">00:00</span>
    </div>

<button id="button1" onclick="myFunction()">    <h2> ü¶ï ‡§°‡§æ‡§Ø‡§®‡§æ‡§∏‡•ã‡§∞ Real Dily ü™ô Coin earn Wallet üí≥</h2></button>


    <div id="loginBox">

<b>‡§Ü‡§™ ‡§á‡§∏ app ‡§∏‡•á Dily ‡§ï‡•á 500 ‡§∞‡•Ç, 1000 ‡§∞‡•Ç ‡§∏‡•á ‡§≠‡•Ä ‡§ú‡§æ‡§¶‡§æ ‡§ï‡§Æ‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§ú‡§ø‡§∏‡•á ‡§Ü‡§™ UPI ID ‡§∏‡•á Withdrawal ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡•§ </b>
  
      <input type="text" id="username" placeholder="Username" />
      <input type="password" id="password" placeholder="Password" />


<button id="loginButton" onclick="login()">‡§≤‡•â‡§ó‡§ø‡§® / ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞</button>
    </div>

   

    <div id="walletBox" class="hidden">
      <h2 id="welcomeText"></h2>



      <div class="balance">Balance: [ <span id="balance">0</span> Dily Coin ] </div> 

      <!-- Notify Area -->
      <div class="notify" id="notifyBox"></div>

      <div class="box" onclick="scratchCard(this)">Scratch & Earn</div>
      <div class="box" onclick="spinWheel()">Spin the Wheel</div>
      <div class="box" id="dailyBtn" onclick="dailyBonus()">Daily Bonus</div>
<div class="box" onclick="withdrawBox()">‡§™‡•à‡§∏‡•á ‡§®‡§ø‡§ï‡§æ‡§≤‡•á</div>
<div id="withdrawSection" class="hidden">
  <h4>UPI ID ‡§°‡§æ‡§≤‡•á‡§Ç:</h4>
  <input type="text" id="upiId" placeholder="example@upi" />

  <h4>Withdraw Amount:</h4>
  <select id="withdrawAmount">
 
 </select>

  <br>
  <button onclick="processWithdraw()">‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç</button>
</div>


<button id="start-btn">ü¶ï ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>

<div id="score">‡§≤‡•á‡§µ‡§≤: 1 | ‡§∏‡•ç‡§ï‡•ã‡§∞: 0 | ‡§ñ‡§æ‡§Ø‡§æ: 0</div>
<div id="lives">Lives: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
<div id="power-indicator">üß≤ ‡§ö‡•Å‡§Ç‡§¨‡§ï‡•Ä‡§Ø ‡§∂‡§ï‡•ç‡§§‡§ø: <span id="magnet-time">0</span> ‡§∏‡•á‡§ï‡§Ç‡§°</div>
<div id="immunity-indicator">üõ°Ô∏è ‡§Ö‡§Æ‡§∞‡§§‡•ç‡§µ ‡§∂‡§ï‡•ç‡§§‡§ø: <span id="immunity-time">0</span> ‡§∏‡•á‡§ï‡§Ç‡§°</div>
<div id="countdown"></div>

<button id="rules-btn" onclick="myDialog.showModal()">‡§ñ‡•á‡§≤‡§®‡•á ‡§ï‡•á ‡§®‡§ø‡§Ø‡§Æ</button>

<dialog id="myDialog">
  <h3>‡§â‡§°‡§º‡§§‡§æ ‡§°‡§æ‡§Ø‡§®‡§æ‡§∏‡•ã‡§∞ - ‡§ó‡•á‡§Æ ‡§ï‡•á ‡§®‡§ø‡§Ø‡§Æ</h3>
  <p>‡§ú‡§ø‡§§‡§®‡§æ ‡§Ö‡§ß‡§ø‡§ï ‡§Ü‡§™ ‡§á‡§∏ ‡§ñ‡•á‡§≤ ‡§ï‡•ã ‡§ñ‡•á‡§≤‡§§‡•á ‡§π‡•à‡§Ç, ‡§á‡§∏ ‡§ñ‡•á‡§≤ ‡§Æ‡•á time ‡§¨‡§ø‡§§‡§æ‡§§‡•á ‡§π‡•à l ‡§â‡§§‡§®‡§æ ‡§π‡•Ä ‡§Ö‡§ß‡§ø‡§ï ‡§∏‡§ø‡§ï‡•ç‡§ï‡§æ ‡§Ü‡§™‡§ï‡•ã ‡§π‡§∞ 1 ‡§Æ‡§ø‡§®‡§ü ‡§Æ‡•á 10+ ‡§ï‡•â‡§á‡§® ü™ô ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à</p>
  <p>‡§î‡§∞ ‡§Ö‡§ß‡§ø‡§ï ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§ï‡§∞‡§®‡•á ‡§™‡§∞ 60 ‡§Æ‡§ø‡§®‡§ü ‡§ñ‡•á‡§≤‡§®‡•á ‡§™‡§∞ Real 300+ü™ô Coine ‡§Æ‡§ø‡§≤‡•á‡§Ç‡§ó‡•á ‡§ú‡§ø‡§∏‡•á ‡§Ü‡§™ UPI ID ‡§∏‡•á ‡§®‡§ø‡§ï‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç l</p>
  <p><b>‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§ú‡§æ‡§®‡§ï‡§∞‡•Ä:</b> ‡§Ö‡§ó‡§∞ ‡§Ü‡§™‡§ï‡•ã ‡§ï‡•â‡§á‡§® ü™ô ‡§ï‡•á ‡§¨‡§¶‡§≤‡•á ‡§™‡•à‡§∏‡•á ‡§®‡§π‡•Ä ‡§Æ‡§ø‡§≤‡§æ ‡§π‡•à ‡§§‡•ã</p>
  <p><b>&#9776;Home</b> ‡§¨‡§ü‡§® ‡§¶‡§æ‡§¨‡§æ‡§ï‡§∞ <a href="#" class="menu-item">Help</a> ‡§≤‡•á ‡§∏‡§ï‡§§‡•á ‡§π‡•à l</p>
  <p>üí≥ UPI ID ‡§°‡§æ‡§≤‡§ï‡§∞ 10 ‡§Æ‡§ø‡§®‡§ü ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§®‡§æ ‡§™‡•à‡§∏‡§æ ‡§®‡§ø‡§ï‡§æ‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç</p>

  <p>ü¶ï ‡§°‡§æ‡§Ø‡§®‡§æ‡§∏‡•ã‡§∞ ‡§ï‡•ã ‡§â‡§°‡§º‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§™‡§∞ ‡§ü‡•à‡§™ ‡§ï‡§∞‡•á‡§Ç ‡§Ø‡§æ ‡§∏‡•ç‡§™‡•á‡§∏ ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§¶‡§¨‡§æ‡§è‡§Ç‡•§</p>
  <p>üåø ‡§π‡§∞‡•á ‡§Ü‡§á‡§ü‡§Æ‡•ç‡§∏ ‡§ï‡•ã ‡§ñ‡§æ‡§è‡§Ç ‡§î‡§∞ ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§¨‡§¢‡§º‡§æ‡§è‡§Ç‡•§</p>
  <p>‚ùå ‡§ñ‡§§‡§∞‡§®‡§æ‡§ï ‡§ö‡•Ä‡§ú‡§º‡•ã‡§Ç (üöó, üî•, üí£) ‡§∏‡•á ‡§¨‡§ö‡•á‡§Ç ‡§µ‡§∞‡§®‡§æ ‡§ó‡•á‡§Æ ‡§ì‡§µ‡§∞ ‡§π‡•ã ‡§ú‡§æ‡§è‡§ó‡§æ‡•§</p>
  <p>üß≤ <b>‡§ö‡•Å‡§Æ‡•ç‡§¨‡§ï:</b> ‡§á‡§∏‡•á ‡§ñ‡§æ‡§®‡•á ‡§™‡§∞ 10 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§§‡§ï ‡§∏‡§≠‡•Ä ‡§Ö‡§ö‡•ç‡§õ‡•á ‡§Ü‡§á‡§ü‡§Æ ‡§Ü‡§™‡§ï‡•Ä ‡§ì‡§∞ ‡§ñ‡§ø‡§Ç‡§ö‡•á‡§Ç‡§ó‡•á!</p>
  <p>‚ú¥Ô∏è <b>‡§Ö‡§Æ‡§∞‡§§‡•ç‡§µ ‡§∂‡§ï‡•ç‡§§‡§ø:</b> ‚ú¥Ô∏èüåÄ‚ú≥Ô∏è‚ùáÔ∏è ‡§á‡§® ‡§Ü‡§á‡§ü‡§Æ‡•ç‡§∏ ‡§ï‡•ã ‡§ñ‡§æ‡§®‡•á ‡§™‡§∞ 30 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§§‡§ï ‡§Ü‡§™ ‡§Ö‡§Æ‡§∞ ‡§π‡•ã ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á!</p>
  <p>üöÑ <b>‡§ü‡•ç‡§∞‡•á‡§® ‡§∏‡•á ‡§∏‡§æ‡§µ‡§ß‡§æ‡§®:</b> ‡§ü‡•ç‡§∞‡•á‡§® ‡§Æ‡•á‡§Ç ‡§ï‡§à ‡§¨‡•ã‡§ó‡§ø‡§Ø‡§æ‡§Ç ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§á‡§®‡•ç‡§π‡•á‡§Ç ‡§™‡§æ‡§∞ ‡§ï‡§∞‡§®‡§æ ‡§ï‡§†‡§ø‡§® ‡§π‡•à!</p>
  <button onclick="myDialog.close()">‡§∏‡§Æ‡§ù ‡§ó‡§Ø‡§æ ‚úñÔ∏è</button>
</dialog>
<button id="mute-btn">üîä</button>
<div id="game">
  <div id="sky"></div>
  <div id="clouds"></div>
  <div id="ground"></div>
  <div id="dino">ü¶ï</div>
</div>
<div id="eaten-items"></div>
<button id="restart-btn">‚Üë ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ñ‡•á‡§≤‡•á‡§Ç</button>
<button id="fly-btn">‚Üë</button>


  <script>
    let sessionSeconds = 0;
    let sessionTimer = null;
    let internetCheckInterval = null;
    let inactiveTime = 0;
    let inactivityCheckTimer = null;
    let maxInactiveTime = 20; // 20 seconds of inactivity before showing modal
    let userActive = true;
    let lastActivityTime = Date.now();
    let wasInactive = false;

    // Function to track user activity
    function trackActivity() {
      lastActivityTime = Date.now();
      
      if (!userActive) {
        userActive = true;
        // If timer was stopped due to inactivity, don't auto-restart it
        // The user must click the resume button
        if (wasInactive) {
          document.getElementById("inactiveModal").style.display = "block";
        }
      }
    }

    // Function to check if user is inactive
    function checkUserActivity() {
      const currentTime = Date.now();
      const timeSinceLastActivity = (currentTime - lastActivityTime) / 1000;
      
      if (timeSinceLastActivity > maxInactiveTime && userActive) {
        userActive = false;
        wasInactive = true;
        stopSessionTimer();
        document.getElementById("inactiveModal").style.display = "block";
      }
    }

    // Resume game after inactivity
    function resumeGame() {
      userActive = true;
      wasInactive = false;
      lastActivityTime = Date.now();
      document.getElementById("inactiveModal").style.display = "none";
      startSessionTimer();
    }

    // Setup activity tracking
    function setupActivityTracking() {
      // Track various user activities
      const events = ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart'];
      
      events.forEach(event => {
        document.addEventListener(event, trackActivity, true);
      });
      
      // Check for inactivity every second
      inactivityCheckTimer = setInterval(checkUserActivity, 1000);
    }

    // Function to check internet connection
    function checkInternetConnection() {
      const noInternetModal = document.getElementById("noInternetModal");
      
      if (!navigator.onLine) {
        noInternetModal.style.display = "block";
        // Also stop the timer when there's no internet
        stopSessionTimer();
      } else {
        noInternetModal.style.display = "none";
        // Don't automatically restart the timer - this should happen on user interaction
      }
    }

    // Set up internet connection monitoring
    function setupInternetMonitoring() {
      // Initial check
      checkInternetConnection();
      
      // Check every 5 seconds
      internetCheckInterval = setInterval(checkInternetConnection, 5000);
      
      // Add event listeners for online/offline events
      window.addEventListener('online', function() {
        document.getElementById("noInternetModal").style.display = "none";
      });
      
      window.addEventListener('offline', function() {
        document.getElementById("noInternetModal").style.display = "block";
        stopSessionTimer();
      });
    }

    // Handle page visibility changes
    document.addEventListener('visibilitychange', function() {
      if (document.visibilityState === 'hidden') {
        // User switched tabs or minimized window
        stopSessionTimer();
        wasInactive = true;
      } else {
        // User came back to the tab
        // Don't auto-restart, show the inactive modal
        if (wasInactive && sessionTimer === null) {
          document.getElementById("inactiveModal").style.display = "block";
        }
      }
    });

    function getUsers() {
      return JSON.parse(localStorage.getItem("users") || "{}");
    }

    function saveUsers(users) {
      localStorage.setItem("users", JSON.stringify(users));
    }

    function login() {
      const username = document.getElementById("username").value.trim();
      const password = document.getElementById("password").value.trim();

      if (!username || !password) {
        alert("Please enter both fields");
        return;
      }

      let users = getUsers();

      if (!users[username]) {
        users[username] = {
          password: password,
          balance: 0,
          lastDaily: null,
          invited: false,
          referredBy: null,
          coinHistory: [], // Initialize coin history array
          savedUpiId: null // Initialize saved UPI ID
        };
        saveUsers(users);
      } else if (users[username].password !== password) {
        alert("Incorrect password");
        return;
      }

      // Initialize coinHistory if it doesn't exist
      if (!users[username].coinHistory) {
        users[username].coinHistory = [];
        saveUsers(users);
      }

      localStorage.setItem("loggedInUser", username);
      showWallet();
    }

    function showWallet() {
      const username = localStorage.getItem("loggedInUser");
      const users = getUsers();

      if (users[username]) {
        document.getElementById("loginBox").classList.add("hidden");
        document.getElementById("walletBox").classList.remove("hidden");
        document.getElementById("welcomeText").innerText = "Welcome, " + username;
        document.getElementById("balance").innerText = users[username].balance;
        checkDaily();
        startSessionTimer();
        updateWithdrawOptions();
        setupActivityTracking(); // Start tracking user activity
        userActive = true;
        lastActivityTime = Date.now();
      }
    }

    function updateBalance(amount, source = "Generic") {
      const username = localStorage.getItem("loggedInUser");
      let users = getUsers();
      
      // Add to balance
      users[username].balance += amount;
      
      // Record in history
      if (!users[username].coinHistory) {
        users[username].coinHistory = [];
      }
      
      users[username].coinHistory.push({
        date: new Date().toISOString(),
        amount: amount,
        source: source
      });
      
      saveUsers(users);
      document.getElementById("balance").innerText = users[username].balance;
    }

    function scratchCard(el) {
      el.innerText = "Please wait...";
      el.style.background = "#999";
      el.style.pointerEvents = "none";
      setTimeout(() => {
        const reward = Math.floor(Math.random() * 4) + 1;
        updateBalance(reward, "Scratch Card");
        el.innerText = `You got ${reward} Coins!`;
        el.style.background = "green";
        window.location.href = "https://example.com/ad"; // ‡§ê‡§° ‡§≤‡§ø‡§Ç‡§ï
      }, 5000); // 5 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§µ‡•á‡§ü
    }

    function spinWheel() {
      alert("Please wait 5 seconds to claim your reward coines...");
      setTimeout(() => {
        const reward = [0, 2, 5, 1, 1, 0, 3, 4][Math.floor(Math.random() * 8)];
        updateBalance(reward, "Spin Wheel");
        alert(`You got ${reward} Coins!`);
        window.location.href = "https://real-dily-coin-wallet.vercel.app/"; // ‡§ê‡§° ‡§≤‡§ø‡§Ç‡§ï
      }, 5000);
    }

    function checkDaily() {
      const username = localStorage.getItem("loggedInUser");
      const users = getUsers();
      const today = new Date().toDateString();

      if (users[username].lastDaily === today) {
        document.getElementById("dailyBtn").innerText = "Daily Bonus (Claimed)";
        document.getElementById("dailyBtn").disabled = true;
      }
    }

    function dailyBonus() {
      const username = localStorage.getItem("loggedInUser");
      const users = getUsers();
      const today = new Date().toDateString();

      if (users[username].lastDaily !== today) {
        alert("Wait 5 seconds to claim your daily bonus...");
        setTimeout(() => {
          updateBalance(5, "Daily Bonus");
          users[username].lastDaily = today;
          saveUsers(users);
          document.getElementById("balance").innerText = users[username].balance;
          document.getElementById("dailyBtn").innerText = "Daily Bonus (Claimed)";
          document.getElementById("dailyBtn").disabled = true;
          alert("You got 5 coins as Daily Bonus!");
          window.location.href = "https://example.com/ad"; // ‡§ê‡§° ‡§≤‡§ø‡§Ç‡§ï
        }, 5000);
      } else {
        alert("‡§Ü‡§™‡§®‡•á ‡§™‡§π‡§≤‡•á ‡§π‡•Ä ‡§Ü‡§ú ‡§ï‡•á 10+ ü™ôCoine ‡§≤‡•á ‡§≤‡§ø‡§Ø‡§æ  ‡§π‡•à l ‡§Ö‡§¨ ‡§Ü‡§™‡§ï‡•ã ‡§Ö‡§ó‡§≤‡§æ 10+ ü™ô Coine ‡§ï‡§≤ ‡§Æ‡§ø‡§≤‡•á‡§ó‡§æ.");
      }
    }

    function claimReferral() {
      const referredBy = document.getElementById("inviteUser").value.trim();
      const currentUser = localStorage.getItem("loggedInUser");
      let users = getUsers();

      if (!referredBy || referredBy === currentUser) {
        alert("Invalid username.");
        return;
      }

      if (!users[referredBy]) {
        alert("This user does not exist.");
        return;
      }

      if (users[currentUser].referredBy) {
        alert("You have already claimed referral bonus.");
        return;
      }

      // Referral success
      users[currentUser].referredBy = referredBy;
      updateBalance(5, "Referral Bonus");
      
      // Add coins to referrer
      users[referredBy].balance += 10;
      
      // Add to referrer's history
      if (!users[referredBy].coinHistory) {
        users[referredBy].coinHistory = [];
      }
      users[referredBy].coinHistory.push({
        date: new Date().toISOString(),
        amount: 10,
        source: `Referral (${currentUser})`
      });
      
      saveUsers(users);

      document.getElementById("balance").innerText = users[currentUser].balance;
      alert("Referral successful! You got 5 ü™ôCoine.");
    }

    function logout() {
      localStorage.removeItem("loggedInUser");
      document.getElementById("loginBox").classList.remove("hidden");
      document.getElementById("walletBox").classList.add("hidden");
      sessionSeconds = 0;
      resetSessionTimerDisplay();
      stopSessionTimer();
      
      // Also clear the inactivity timer
      if (inactivityCheckTimer) {
        clearInterval(inactivityCheckTimer);
        inactivityCheckTimer = null;
      }
    }

    function startSessionTimer() {
      if (sessionTimer) return;
      sessionTimer = setInterval(() => {
        sessionSeconds++;
        updateTimerDisplay();

        // ‡§π‡§∞ 1 ‡§Æ‡§ø‡§®‡§ü ‡§™‡§∞ 10 Coin ‡§¶‡•á‡§Ç
        if (sessionSeconds % 60 === 0) {
          updateBalance(10, "Time Reward (1 minute)");
          showNotification("‡§Ü‡§™‡§ï‡•ã 1 ‡§Æ‡§ø‡§®‡§ü ‡§ñ‡•á‡§≤‡§®‡•á ‡§™‡§∞ 10+ü™ôCoin ‡§Æ‡§ø‡§≤‡•á ‡§π‡•à! ‡§á‡§∏‡•Ä ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ñ‡•á‡§≤‡§§‡•á ‡§∞‡§π‡•á 60 ‡§Æ‡§ø‡§®‡§ü ‡§ñ‡•á‡§≤‡•á‡§Ç‡§ó‡•á ‡§§‡•ã 300+ü™ôCoin ‡§Æ‡§ø‡§≤‡•á‡§Ç‡§ó‡•á ");
        }

        // ‡§π‡§∞ 60 ‡§Æ‡§ø‡§®‡§ü ‡§™‡§∞ 300 Coin ‡§¶‡•á‡§Ç
        if (sessionSeconds % 3600 === 0) {
          updateBalance(300, "Time Reward (60 minutes)");
          showNotification("‡§Ü‡§™‡§ï‡•ã 60 ‡§Æ‡§ø‡§®‡§ü ‡§ñ‡•á‡§≤‡§®‡•á ‡§™‡§∞ 300+ü™ôCoin ‡§Æ‡§ø‡§≤‡•á!");
        }

      }, 1000);
    }

    function stopSessionTimer() {
      if (sessionTimer) {
        clearInterval(sessionTimer);
        sessionTimer = null;
      }
    }

    function resetSessionTimerDisplay() {
      document.getElementById("timeElapsed").innerText = "00:00";
    }

    function updateTimerDisplay() {
      let minutes = Math.floor(sessionSeconds / 60);
      let seconds = sessionSeconds % 60;
      minutes = minutes < 10 ? "0" + minutes : minutes;
      seconds = seconds < 10 ? "0" + seconds : seconds;
      document.getElementById("timeElapsed").innerText = `${minutes}:${seconds}`;
    }

    function showNotification(message) {
      const box = document.getElementById("notifyBox");
      box.innerText = message;
      box.style.display = "block";
      setTimeout(() => {
        box.style.display = "none";
      }, 4000);
    }

    function withdrawBox() {
      const withdrawDiv = document.getElementById("withdrawSection");
      withdrawDiv.classList.toggle("hidden");
      
      // Fill in saved UPI ID if available
      const username = localStorage.getItem("loggedInUser");
      const users = getUsers();
      
      if (users[username] && users[username].savedUpiId) {
        document.getElementById("upiId").value = users[username].savedUpiId;
      }
    }

    function processWithdraw() {
      const upi = document.getElementById("upiId").value.trim();
      const option = document.getElementById("withdrawAmount").value;
      const [coinCost, rupees] = option.split("-").map(Number);
      const username = localStorage.getItem("loggedInUser");
      let users = getUsers();

      if (!upi.includes("@")) {
        alert("Valid UPI ID ‡§°‡§æ‡§≤‡•á‡§Ç‡•§");
        return;
      }

      if (users[username].balance < coinCost) {
        alert("‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏ ‡§™‡§∞‡•ç‡§Ø‡§æ‡§™‡•ç‡§§ ü™ô Coin ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç‡•§");
        return;
      }

      if (!users[username].withdrawnOptions) {
        users[username].withdrawnOptions = [];
      }

      if (users[username].withdrawnOptions.includes(option)) {
        alert("‡§Ü‡§™ ‡§™‡§π‡§≤‡•á ‡§π‡•Ä ‡§á‡§∏ ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§∏‡•á ‡§™‡•à‡§∏‡•á ‡§®‡§ø‡§ï‡§æ‡§≤ ‡§ö‡•Å‡§ï‡•á ‡§π‡•à‡§Ç‡•§");
        return;
      }

      // Save the UPI ID for future use
      users[username].savedUpiId = upi;

      users[username].balance -= coinCost;
      users[username].withdrawnOptions.push(option);
      
      // Add withdrawal to history
      if (!users[username].coinHistory) {
        users[username].coinHistory = [];
      }
      users[username].coinHistory.push({
        date: new Date().toISOString(),
        amount: -coinCost,
        source: `Withdrawal (‚Çπ${rupees} to ${upi})`
      });
      
      saveUsers(users);
      document.getElementById("balance").innerText = users[username].balance;
      alert(`‚Çπ${rupees} ‡§ï‡•Ä ‡§®‡§ø‡§ï‡§æ‡§∏‡•Ä ‡§∏‡§´‡§≤! ‡§™‡•à‡§∏‡•á ‡§ú‡§≤‡•ç‡§¶ ‡§π‡•Ä ${upi} ‡§™‡§∞ ‡§≠‡•á‡§ú ‡§¶‡§ø‡§è ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á‡•§`);
      document.getElementById("withdrawSection").classList.add("hidden");

      updateWithdrawOptions();
    }

    function fillReferralFromURL() {
      const params = new URLSearchParams(window.location.search);
      const ref = params.get("ref");
      if (ref) {
        const inviteInput = document.getElementById("inviteUser");
        if (inviteInput) {
          inviteInput.value = ref;
        }
      }
    }

    function shareApp() {
      const username = localStorage.getItem("loggedInUser") || "guest";
      const shareLink = `${window.location.origin}${window.location.pathname}?ref=${username}`;

      const shareData = {
        title: 'Dily Coin Wallet',
        text: `‡§°‡§æ‡§Ø‡§®‡§æ‡§∏‡•ã‡§∞ Real Dily Coin Wallet ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡§Æ‡§æ‡§è‡§Ç ‡§∞‡•ã‡§ú‡§º ‡§ï‡•á Coins ‡§î‡§∞ ‡§™‡•à‡§∏‡•á ‚Äî ‡§∏‡•Ä‡§ß‡•á ‡§Ö‡§™‡§®‡•á ‡§µ‡•â‡§≤‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§ï‡§∞‡•á‡§Ç ‡§µ‡§ø‡§¶‡§°‡•ç‡§∞‡•â

‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§≠‡•Ä ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§∏‡•á ‡§™‡•à‡§∏‡•á ‡§ï‡§Æ‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç? ‡§§‡•ã ‡§Ö‡§¨ ‡§°‡§æ‡§Ø‡§®‡§æ‡§∏‡•ã‡§∞ Real Dily Coin Wallet ‡§™‡§∞ ‡§Æ‡•á‡§∞‡•á ‡§∏‡§æ‡§• ‡§ú‡•Å‡§°‡§º‡•á‡§Ç ‡§î‡§∞ ‡§π‡§∞ ‡§¶‡§ø‡§® ‡§™‡§æ‡§è‡§Ç ‡§´‡•ç‡§∞‡•Ä ‡§ï‡•â‡§á‡§®, ‡§ï‡•à‡§∂,

- ‡§π‡§∞ ‡§¶‡§ø‡§® ‡§≤‡•â‡§ó‡§ø‡§® ‡§¨‡•ã‡§®‡§∏
- ‡§ó‡•á‡§Æ ‡§ñ‡•á‡§≤‡§ï‡§∞ ‡§´‡•ç‡§∞‡•Ä ‡§ï‡•â‡§á‡§®
- ‡§¶‡•ã‡§∏‡•ç‡§§‡•ã‡§Ç ‡§ï‡•ã ‡§á‡§®‡§µ‡§æ‡§á‡§ü ‡§ï‡§∞‡§ï‡•á ‡§è‡§ï‡•ç‡§∏‡•ç‡§ü‡•ç‡§∞‡§æ ‡§ï‡§Æ‡§æ‡§à

‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡§π‡§æ‡§Ç ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Çüëá!`,
        url: shareLink
      };

      if (navigator.share) {
        navigator.share(shareData)
          .then(() => {
            console.log('Shared successfully');
          })
          .catch((error) => {
            console.error('Error sharing:', error);
          });
      } else {
        // Fallback for unsupported browsers
        const fallbackMessage = `Share this link with your friends:\n\n${shareLink}`;
        prompt("Copy and share this link:", shareLink);
      }
    }
    
    function toggleMenu() {
      const menu = document.getElementById("homeMenu");
      menu.style.display = menu.style.display === "block" ? "none" : "block";
    }

    function updateWithdrawOptions() {
      const username = localStorage.getItem("loggedInUser");
      const users = getUsers();
      const select = document.getElementById("withdrawAmount");
      const allOptions = [
        { value: "100-2", text: "100 Coin = ‚Çπ2" },
        { value: "20000-300", text: "20000 Coin = ‚Çπ300" },
        { value: "40000-500", text: "40000 Coin = ‚Çπ500" },
        { value: "80000-1000", text: "80000 Coin = ‚Çπ1000" },
        { value: "100000-2000", text: "100000 Coin = ‚Çπ2000" },
        { value: "200000-3000", text: "200000 Coin = ‚Çπ3000" },
        { value: "400000-5000", text: "400000 Coin = ‚Çπ5000" },
        { value: "800000-10000", text: "800000 Coin = ‚Çπ10000" }
      ];

      select.innerHTML = "";

      const withdrawn = users[username].withdrawnOptions || [];

      const available = allOptions.filter(opt => !withdrawn.includes(opt.value));

      if (available.length === 0) {
        const o = document.createElement("option");
        o.textContent = "‡§ï‡•ã‡§à ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à";
        o.disabled = true;
        o.selected = true;
        select.appendChild(o);
        select.disabled = true;
      } else {
        select.disabled = false;
        available.forEach(opt => {
          const o = document.createElement("option");
          o.value = opt.value;
          o.textContent = opt.text;
          select.appendChild(o);
        });
      }
    }

    // History related functions
    function showHistory() {
      const username = localStorage.getItem("loggedInUser");
      const users = getUsers();
      
      if (!users[username]) return;
      
      const historyList = document.getElementById("historyList");
      historyList.innerHTML = "";
      
      // Get history array
      const history = users[username].coinHistory || [];
      
      if (history.length === 0) {
        historyList.innerHTML = "<p>No coine history available yet.</p>";
      } else {
        // Sort history by date (newest first)
        history.sort((a, b) => new Date(b.date) - new Date(a.date));
        
        history.forEach(item => {
          const date = new Date(item.date);
          const formattedDate = `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;
          
          const historyItem = document.createElement("div");
          historyItem.className = "history-item";
          
          historyItem.innerHTML = `
            <div class="history-date">${formattedDate}</div>
            <div class="history-amount">${item.amount > 0 ? '+' : ''}${item.amount} Coins</div>
            <div class="history-source">Source: ${item.source}</div>
          `;
          
          historyList.appendChild(historyItem);
        });
      }
      
      document.getElementById("historyModal").style.display = "block";
    }
    
    function closeHistory() {
      document.getElementById("historyModal").style.display = "none";
    }

    // Close modal if clicking outside of it
    window.onclick = function(event) {
      const modal = document.getElementById("historyModal");
      if (event.target == modal) {
        modal.style.display = "none";
      }
    };

    function myFunction() {
      // Function placeholder for button clicks
      console.log("Button clicked");
    }

    // Save timer state before page unload
    window.addEventListener('beforeunload', function() {
      // If the timer is running, mark that the user left
      if (sessionTimer !== null) {
        wasInactive = true;
        stopSessionTimer();
      }
    });

    window.onload = () => {
      fillReferralFromURL();
      const username = localStorage.getItem("loggedInUser");
      if (username && getUsers()[username]) {
        showWallet();
      }
      
      // Setup internet connection monitoring
      setupInternetMonitoring();
    };


const startBtn = document.getElementById("start-btn");
const dino = document.getElementById("dino");
const game = document.getElementById("game");
const scoreDisplay = document.getElementById("score");
const livesDisplay = document.getElementById("lives");
const sky = document.getElementById("sky");
const clouds = document.getElementById("clouds");
const restartBtn = document.getElementById("restart-btn");
const flyBtn = document.getElementById("fly-btn");
const muteBtn = document.getElementById("mute-btn");
const eatenItemsBox = document.getElementById("eaten-items");
const powerIndicator = document.getElementById("power-indicator");
const magnetTimeDisplay = document.getElementById("magnet-time");
const immunityIndicator = document.getElementById("immunity-indicator");
const immunityTimeDisplay = document.getElementById("immunity-time");
const countdownDisplay = document.getElementById("countdown");

startBtn.addEventListener("click", () => {
  startBtn.style.display = "none"; // ‡§¨‡§ü‡§® ‡§ï‡•ã ‡§õ‡•Å‡§™‡§æ‡§è‡§Ç
  startGameWithCountdown(); // ‡§ï‡§æ‡§â‡§Ç‡§ü‡§°‡§æ‡§â‡§® ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ó‡•á‡§Æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç
});

let score = 0;
let eaten = 0;
let level = 1;
let gameSpeed = 3;
let isFlying = false;
let isMuted = false;
let flyInterval;
let fallInterval;
let obstacleInterval;
let scoreInterval;
let cloudInterval;
let magnetSpawnInterval;
let immunitySpawnInterval;
let magnetEffectInterval;
let immunityEffectInterval;
let magnetTimeLeft = 0;
let immunityTimeLeft = 0;
let hasMagneticPower = false;
let hasImmunity = false;
let isGameOver = false;
let eatenItems = [];
let dinoBottom = 0;
let lives = 3; // ‡§§‡•Ä‡§® ‡§ú‡§æ‡§® ‡§ï‡§æ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ
let playTime = 0; // ‡§ñ‡•á‡§≤‡§®‡•á ‡§ï‡§æ ‡§∏‡§Æ‡§Ø (‡§∏‡•á‡§ï‡§Ç‡§° ‡§Æ‡•á‡§Ç)
let coinEarned = 0; // ‡§ï‡§Æ‡§æ‡§è ‡§ó‡§è ‡§ï‡•â‡§á‡§®

// ‡§ï‡§æ‡§â‡§Ç‡§ü‡§°‡§æ‡§â‡§® ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ó‡•á‡§Æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
function startGameWithCountdown() {
  countdownDisplay.style.display = "block";
  countdownDisplay.textContent = "3";
  
  // ‡§ï‡§æ‡§â‡§Ç‡§ü‡§°‡§æ‡§â‡§® ‡§∏‡§æ‡§â‡§Ç‡§°
  if(!isMuted) {
    const countSound = new Audio('https://www.soundjay.com/buttons/sounds/button-09.mp3');
    countSound.play();
  }
  
  setTimeout(() => {
    countdownDisplay.textContent = "2";
    countdownDisplay.style.animation = "none";
    void countdownDisplay.offsetWidth; // ‡§∞‡•Ä‡§´‡•ç‡§≤‡•ã
    countdownDisplay.style.animation = "scale-in 0.5s ease-out";
    
    // ‡§ï‡§æ‡§â‡§Ç‡§ü‡§°‡§æ‡§â‡§® ‡§∏‡§æ‡§â‡§Ç‡§°
    if(!isMuted) {
      const countSound = new Audio('https://www.soundjay.com/buttons/sounds/button-09.mp3');
      countSound.play();
    }
    
    setTimeout(() => {
      countdownDisplay.textContent = "1";
      countdownDisplay.style.animation = "none";
      void countdownDisplay.offsetWidth; // ‡§∞‡•Ä‡§´‡•ç‡§≤‡•ã
      countdownDisplay.style.animation = "scale-in 0.5s ease-out";
      
      // ‡§ï‡§æ‡§â‡§Ç‡§ü‡§°‡§æ‡§â‡§® ‡§∏‡§æ‡§â‡§Ç‡§°
      if(!isMuted) {
        const countSound = new Audio('https://www.soundjay.com/buttons/sounds/button-09.mp3');
        countSound.play();
      }
      
      setTimeout(() => {
        countdownDisplay.textContent = "GO!";
        countdownDisplay.style.animation = "none";
        void countdownDisplay.offsetWidth; // ‡§∞‡•Ä‡§´‡•ç‡§≤‡•ã
        countdownDisplay.style.animation = "scale-in 0.5s ease-out";
        
        // ‡§ó‡•ã ‡§∏‡§æ‡§â‡§Ç‡§°
        if(!isMuted) {
          const goSound = new Audio('https://www.soundjay.com/misc/sounds/coin-drop-4.mp3');
          goSound.play();
        }
        
        setTimeout(() => {
          countdownDisplay.style.display = "none";
          startGame(); // ‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï ‡§ó‡•á‡§Æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç
        }, 700);
      }, 1000);
    }, 1000);
  }, 1000);
}

const levelThresholds = [500, 1000, 1500, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 10000, 15000, 20000, 30000, 40000, 50000];
const dayEmojis = ["‚òÄ", "üå§", "‚õÖ", "üåà"];
const nightEmojis = ["üåô", "‚≠ê", "‚ú®", "üåü"];
const cloudEmojis = ["‚òÅÔ∏è", "üå•", "üå¶", "üåß"];
const magnetItem = "üß≤";

const immunityItems = ["‚ú¥Ô∏è", "üåÄ", "‚ú≥Ô∏è", "‚ùáÔ∏è"];

const leafItems = [
  "üåø", "‚òòÔ∏è", "üå±", "üåµ", "üå¥", "üå≥", "üå≤", "üéÑ", "üéã", "üçÉ",
  "üå≤", "üå≥", "üéÑ", "üå¥", "üå±", "üåø", "‚òòÔ∏è", "üçÑ", "üçÅ", "üçÇ", "üçÉ",
  "üéã", "üéç", "üçÄ", "üåæ", "üíê", "üçè", "üçé", "üçê", "üçä", "üçã", "üçå", "üçâ", "üçç", "ü•≠", "üçë", "üçí", "üçà", "üçì", "üçá", "ü••", "ü•ù", "ü•ë", "üçÖ", "ü•¶", "ü•¨",
  "üçè", "üçé", "üçê", "üçä", "üçã", "üçå", "üçâ", "üçç", "ü•≠", "üçë", "ü•¶", "üçÜ", "üçÖ", "ü•ë", "üçà", "ü•ù", "ü•í", "ü•ï",
  "üåÆ", "üçï", "ü•™", "üçÅ", "üçÇ", "üçÉ", "üå¥", "üå±", "üå≥"
];
        
const otherItems = [
    "üêò", "üöó", "üêÜ", "üî•", "ü¶è", "ü™®", "üßå", "üõû", "üêä", "ü¶Ç",
    "üöì", "üöë", "üí£", "üöú", "üöõ", "üöÅ", "üèú", "üè•", "üß®", "‚öîÔ∏è", "‚ùå",
    "üå™", "üåä", "üöó", "üöï", "üöô", "üöå", "üöé", "üèé", "üöì", "üöë", "üöí", "üöê",
    "üöö", "üöõ", "üöú", "üö†", "üö°", "üöã", "üöÇ", "üöÑ", "üöÖ", "üöà",
    "üöÅ", "üöÅ", "üóº", "‚õ∞Ô∏è", "üèî", "üåâ",
    "üî®", "‚öíÔ∏è", "üõ†", "‚õèÔ∏è", "üí£", "üí£", "üí£", "üî´", "‚õìÔ∏è",
    "üß±", "üß±", "üß±", "üß±", "‚öôÔ∏è", "ü™ì", "üß®", "üî™", "üó°", "‚öîÔ∏è"
];

// ‡§ü‡•ç‡§∞‡•á‡§® ‡§Ü‡§á‡§ü‡§Æ‡•ç‡§∏
const trainItems = ["üöÑ", "üöÖ"]; 
const trainCarItems = ["üöÉ", "üöã", "üöé"];

const obstacles = [...leafItems, ...otherItems, ...trainItems];

// ‡§∏‡§æ‡§â‡§Ç‡§° ‡§á‡§®‡§ø‡§∂‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º‡•á‡§∂‡§®
const audio = {
  jump: new Audio('https://www.soundjay.com/buttons/sounds/button-09.mp3'),
  eat: new Audio('https://www.soundjay.com/buttons/sounds/button-14.mp3'),
  magnet: new Audio('https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3'),
  immunity: new Audio('https://www.soundjay.com/misc/sounds/coin-drop-4.mp3'),
  gameOver: new Audio('https://www.soundjay.com/misc/sounds/fail-buzzer-03.mp3'),
  bgm: new Audio('https://www.soundjay.com/nature/sounds/rain-07.mp3'),
  loseLife: new Audio('https://www.soundjay.com/misc/sounds/failure-drum-sound-effect-2.mp3'),
  train: new Audio('https://www.soundjay.com/transportation/sounds/train-whistle-01.mp3'),
  coin: new Audio('https://www.soundjay.com/misc/sounds/coin-drop-4.mp3')
};

// BGM ‡§ï‡•ã ‡§≤‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ö‡§≤‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è
audio.bgm.loop = true;

function startFlying() {
  if (isGameOver) return;
  if(!isMuted) audio.jump.play();
  
  isFlying = true;
  clearInterval(fallInterval);
  dino.classList.add('jump');
  setTimeout(() => dino.classList.remove('jump'), 500);

  flyInterval = setInterval(() => {
    dinoBottom += 5;
    if (dinoBottom > 180) dinoBottom = 180;
    dino.style.bottom = dinoBottom + "px";
  }, 20);
}

function stopFlying() {
  if (isGameOver) return;
  isFlying = false;
  clearInterval(flyInterval);
  
  fallInterval = setInterval(() => {
    dinoBottom -= 5;
    if (dinoBottom < 0) {
      dinoBottom = 0;
      clearInterval(fallInterval);
    }
    dino.style.bottom = dinoBottom + "px";
  }, 20);
}

// ‡§ï‡§Ç‡§ü‡•ç‡§∞‡•ã‡§≤‡•ç‡§∏ ‡§∏‡•á‡§ü‡§Ö‡§™
document.addEventListener("touchstart", startFlying);
document.addEventListener("touchend", stopFlying);
document.addEventListener("mousedown", startFlying);
document.addEventListener("mouseup", stopFlying);
document.addEventListener("keydown", (e) => {
  if (e.code === "Space") startFlying();
});
document.addEventListener("keyup", (e) => {
  if (e.code === "Space") stopFlying();
});
flyBtn.addEventListener("mousedown", startFlying);
flyBtn.addEventListener("mouseup", stopFlying);
flyBtn.addEventListener("touchstart", startFlying);
flyBtn.addEventListener("touchend", stopFlying);

function updateLives() {
  livesDisplay.innerHTML = `‡§ú‡§æ‡§®: ${"‚ù§Ô∏è".repeat(lives)}`;
}

function loseLife() {
  if (lives > 0) {
    lives--;
    updateLives();
    
    // ‡§ú‡§æ‡§® ‡§ñ‡•ã‡§®‡•á ‡§™‡§∞ ‡§è‡§®‡§ø‡§Æ‡•á‡§∂‡§®
    livesDisplay.classList.add("heart-lost");
    setTimeout(() => livesDisplay.classList.remove("heart-lost"), 500);
    
    if(!isMuted) audio.loseLife.play();
    
    if (lives === 0) {
      gameOver();
    } else {
      // ‡§ú‡§æ‡§® ‡§ñ‡•ã‡§®‡•á ‡§™‡§∞ ‡§°‡§æ‡§Ø‡§®‡§æ‡§∏‡•ã‡§∞ ‡§ï‡•ã ‡§ï‡•Å‡§õ ‡§∏‡§Æ‡§Ø ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§Æ‡•ç‡§Ø‡•Å‡§®‡§ø‡§ü‡•Ä
      hasImmunity = true;
      dino.classList.add("immune");
      setTimeout(() => {
        hasImmunity = false;
        dino.classList.remove("immune");
      }, 1500);
    }
  }
}

function startGame() {
  isGameOver = false;
  score = 0;
  level = 1;
  eaten = 0;
  lives = 3; // ‡§§‡•Ä‡§® ‡§ú‡§æ‡§® ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç
  eatenItems = [];
  gameSpeed = 3;
  dinoBottom = 0;
  magnetTimeLeft = 0;
  immunityTimeLeft = 0;
  hasMagneticPower = false;
  hasImmunity = false;
  dino.textContent = "ü¶ï";
  dino.style.bottom = "0px";
  dino.classList.remove("magnetized");
  dino.classList.remove("immune");
  restartBtn.style.display = "none";
  powerIndicator.style.display = "none";
  immunityIndicator.style.display = "none";
  eatenItemsBox.innerHTML = "";
  document.querySelectorAll(".obstacle").forEach(ob => ob.remove());
  document.querySelectorAll(".train-car").forEach(car => car.remove());
  
  updateLives(); // ‡§ú‡§æ‡§® ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
  
  if(!isMuted) audio.bgm.play();
  
  scoreInterval = setInterval(() => {
    score++;
    updateScore();
    
    // ‡§ï‡•â‡§á‡§® ‡§ï‡§Æ‡§æ‡§à ‡§ï‡§æ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ - ‡§π‡§∞ 60 ‡§∏‡•á‡§ï‡§Ç‡§° (1 ‡§Æ‡§ø‡§®‡§ü) ‡§™‡§∞ 10 ‡§ï‡•â‡§á‡§®
    playTime += 0.2;
    if (playTime % 60 < 0.2 && playTime > 1) {
      coinEarned += 10;
      if(!isMuted) audio.coin.play();
      const coinMsg = document.createElement("div");
      coinMsg.innerHTML = "+10 ü™ô";
      coinMsg.style.position = "fixed";
      coinMsg.style.top = "50%";
      coinMsg.style.left = "50%";
      coinMsg.style.transform = "translate(-50%, -50%)";
      coinMsg.style.color = "gold";
      coinMsg.style.fontSize = "36px";
      coinMsg.style.fontWeight = "bold";
      coinMsg.style.textShadow = "0 0 10px rgba(0,0,0,0.5)";
      coinMsg.style.zIndex = "1000";
      document.body.appendChild(coinMsg);
      coinMsg.classList.add("special-effect");
      setTimeout(() => coinMsg.remove(), 2000);
    }
    
    // ‡§≤‡•á‡§µ‡§≤ ‡§Ö‡§™‡§°‡•á‡§ü
    if (score % 100 === 0) {
      gameSpeed *= 0.97;
      clearInterval(obstacleInterval);
      obstacleInterval = setInterval(spawnObstacle, gameSpeed * 1000);
    }
  }, 200);

  obstacleInterval = setInterval(spawnObstacle, gameSpeed * 1000);
  cloudInterval = setInterval(spawnCloud, 3000);
  magnetSpawnInterval = setInterval(spawnMagnet, 60000); // ‡§π‡§∞ 1 ‡§Æ‡§ø‡§®‡§ü ‡§Æ‡•á‡§Ç ‡§ö‡•Å‡§Ç‡§¨‡§ï ‡§∏‡•ç‡§™‡•â‡§® ‡§ï‡§∞‡•á‡§Ç
  immunitySpawnInterval = setInterval(spawnImmunityItem, 30000); // ‡§π‡§∞ 30 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§Æ‡•á‡§Ç ‡§á‡§Æ‡•ç‡§Ø‡•Å‡§®‡§ø‡§ü‡•Ä ‡§Ü‡§á‡§ü‡§Æ ‡§∏‡•ç‡§™‡•â‡§® ‡§ï‡§∞‡•á‡§Ç
}

function spawnImmunityItem() {
  if (isGameOver) return;
  
  // 2% ‡§ö‡§æ‡§Ç‡§∏ ‡§π‡§∞ ‡§¨‡§æ‡§∞ ‡§ú‡§¨ ‡§ï‡•ã‡§à ‡§Ü‡§á‡§ü‡§Æ ‡§∏‡•ç‡§™‡•â‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à
  if (Math.random() > 0.02 && !window.forceImmunity) return;
  window.forceImmunity = false;
  
  const immunityItem = document.createElement("div");
  immunityItem.className = "obstacle";
  const randomImmuneEmoji = immunityItems[Math.floor(Math.random() * immunityItems.length)];
  immunityItem.textContent = randomImmuneEmoji;
  immunityItem.dataset.emoji = randomImmuneEmoji;
  immunityItem.style.animationDuration = `${gameSpeed}s`;
  
  // ‡§∞‡•à‡§Ç‡§°‡§Æ ‡§ä‡§Ç‡§ö‡§æ‡§à ‡§™‡§∞ ‡§∏‡•ç‡§™‡•â‡§® ‡§ï‡§∞‡•á‡§Ç
  if(Math.random() > 0.5) {
    immunityItem.style.bottom = Math.floor(Math.random() * 150) + "px";
  } else {
    immunityItem.style.bottom = "0px";
  }
  
  game.appendChild(immunityItem);
  setTimeout(() => {
    if (immunityItem && immunityItem.parentNode) immunityItem.remove();
  }, gameSpeed * 1000 + 500);
}

function activateImmunity() {
  if (isGameOver) return;
  
  hasImmunity = true;
  immunityTimeLeft = 30; // 30 ‡§∏‡•á‡§ï‡§Ç‡§°
  immunityIndicator.style.display = "block";
  dino.classList.add("immune");
  
  if (!isMuted) audio.immunity.play();
  
  // ‡§á‡§Æ‡•ç‡§Ø‡•Å‡§®‡§ø‡§ü‡•Ä ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§π‡§∞ ‡§´‡•ç‡§∞‡•á‡§Æ ‡§™‡§∞ ‡§ö‡•á‡§ï ‡§ï‡§∞‡•á‡§Ç
  clearInterval(immunityEffectInterval);
  immunityEffectInterval = setInterval(() => {
    immunityTimeLeft -= 0.1;
    immunityTimeDisplay.textContent = immunityTimeLeft.toFixed(1);
    
    if (immunityTimeLeft <= 0) {
      clearInterval(immunityEffectInterval);
      hasImmunity = false;
      immunityIndicator.style.display = "none";
      dino.classList.remove("immune");
    }
  }, 100);
}

function spawnMagnet() {
  if (isGameOver) return;
  
  // 1% ‡§ö‡§æ‡§Ç‡§∏ ‡§π‡§∞ ‡§¨‡§æ‡§∞ ‡§ú‡§¨ ‡§ï‡•ã‡§à ‡§Ü‡§á‡§ü‡§Æ ‡§∏‡•ç‡§™‡•â‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à
  if (Math.random() > 0.01 && !window.forceMagnet) return;
  window.forceMagnet = false;
  
  const magnet = document.createElement("div");
  magnet.className = "obstacle";
  magnet.textContent = "üß≤";
  magnet.dataset.emoji = "üß≤";
  magnet.style.animationDuration = `${gameSpeed}s`;
  
  // ‡§∞‡•à‡§Ç‡§°‡§Æ ‡§ä‡§Ç‡§ö‡§æ‡§à ‡§™‡§∞ ‡§∏‡•ç‡§™‡•â‡§® ‡§ï‡§∞‡•á‡§Ç
  if(Math.random() > 0.5) {
    magnet.style.bottom = "100px";
  } else {
    magnet.style.bottom = "0px";
  }
  
  game.appendChild(magnet);
  setTimeout(() => {
    if (magnet && magnet.parentNode) magnet.remove();
  }, gameSpeed * 1000 + 500);
}

function activateMagneticPower() {
  if (isGameOver) return;
  
  hasMagneticPower = true;
  magnetTimeLeft = 10; // 10 ‡§∏‡•á‡§ï‡§Ç‡§°
  powerIndicator.style.display = "block";
  dino.classList.add("magnetized");
  
  if (!isMuted) audio.magnet.play();
  
  // ‡§Æ‡•à‡§ó‡•ç‡§®‡•á‡§ü‡§ø‡§ï ‡§™‡§æ‡§µ‡§∞ ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§π‡§∞ ‡§´‡•ç‡§∞‡•á‡§Æ ‡§™‡§∞ ‡§ö‡•á‡§ï ‡§ï‡§∞‡•á‡§Ç
  clearInterval(magnetEffectInterval);
  magnetEffectInterval = setInterval(() => {
    magnetTimeLeft -= 0.1;
    magnetTimeDisplay.textContent = magnetTimeLeft.toFixed(1);
    
    if (magnetTimeLeft <= 0) {
      clearInterval(magnetEffectInterval);
      hasMagneticPower = false;
      powerIndicator.style.display = "none";
      dino.classList.remove("magnetized");
    }
  }, 100);
}

function spawnCloud() {
  const cloud = document.createElement("div");
  cloud.className = "cloud";
  cloud.textContent = cloudEmojis[Math.floor(Math.random() * cloudEmojis.length)];
  cloud.style.top = Math.random() * 100 + "px";
  cloud.style.animationDuration = (10 + Math.random() * 20) + "s";
  clouds.appendChild(cloud);
  setTimeout(() => cloud.remove(), 30000);
}

function updateScore() {
  scoreDisplay.innerHTML = `‡§≤‡•á‡§µ‡§≤: ${level} | ‡§∏‡•ç‡§ï‡•ã‡§∞: ${score} | ‡§ñ‡§æ‡§Ø‡§æ: ${eaten}`;
  
  const nextThreshold = levelThresholds[level-1];
  if(nextThreshold && score >= nextThreshold) {
    level++;
    gameSpeed *= 0.85;
    clearInterval(obstacleInterval);
    obstacleInterval = setInterval(spawnObstacle, gameSpeed * 800);
    spawnObstacle();
    if(!isMuted) audio.eat.play();
  }
}


function spawnObstacle() {
  if (isGameOver) return;
  const ob = document.createElement("div");
  ob.className = "obstacle";
  
  // ‡§≤‡•á‡§µ‡§≤ ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§ñ‡§§‡§∞‡§®‡§æ‡§ï ‡§Ü‡§á‡§ü‡§Æ‡•ç‡§∏ ‡§ï‡•Ä ‡§™‡•ç‡§∞‡•ã‡§¨‡•á‡§¨‡§ø‡§≤‡§ø‡§ü‡•Ä ‡§¨‡§¢‡§º‡§æ‡§è‡§Ç
  const harmfulProbability = Math.min(0.2 + (level*0.05), 0.6);
  
  // ‡§Ö‡§Æ‡§∞‡§§‡•ç‡§µ ‡§Ü‡§á‡§ü‡§Æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§õ‡•ã‡§ü‡§æ ‡§ö‡§æ‡§Ç‡§∏ (3%)
  if (Math.random() < 0.03) {
    const randomImmuneEmoji = immunityItems[Math.floor(Math.random() * immunityItems.length)];
    ob.textContent = randomImmuneEmoji;
    ob.dataset.emoji = randomImmuneEmoji;
  }
  // 1% ‡§ö‡§æ‡§Ç‡§∏ ‡§ö‡•Å‡§Ç‡§¨‡§ï ‡§∏‡•ç‡§™‡•â‡§® ‡§π‡•ã‡§®‡•á ‡§ï‡§æ
  else if (Math.random() < 0.01) {
    ob.textContent = "üß≤";
    ob.dataset.emoji = "üß≤";
  } else {
    const pool = Math.random() < harmfulProbability ? otherItems : leafItems;
    const emoji = pool[Math.floor(Math.random() * pool.length)];
    ob.textContent = emoji;
    ob.dataset.emoji = emoji;

    // ‡§ü‡•ç‡§∞‡•á‡§® ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡•ã‡§ó‡§ø‡§Ø‡§æ‡§Ç ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
    if (trainItems.includes(emoji)) {
  spawnTrainWithCarriages(ob);
}
}

  ob.style.animationDuration = `${gameSpeed}s`;

  if(level > 3 && Math.random() < 0.4) {
    ob.style.bottom = "100px";
  } else {
    ob.style.bottom = Math.random() > 0.7 ? "100px" : "0px";
  }

  game.appendChild(ob);
  setTimeout(() => {
    if (ob && ob.parentNode) ob.remove();
  }, gameSpeed * 1000 + 500);
}

// ‡§®‡§Ø‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®: ‡§ü‡•ç‡§∞‡•á‡§® ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡•ã‡§ó‡§ø‡§Ø‡§æ‡§Ç ‡§¨‡§®‡§æ‡§è‡§Ç
function spawnTrainWithCarriages(train) {
  const numCarriages = 5; // ‡§ü‡§ø‡§¨‡•ç‡§¨‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ
  const carriageSpacing = 45; // ‡§ü‡§ø‡§¨‡•ç‡§¨‡•ã‡§Ç ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§ï‡•Ä ‡§¶‡•Ç‡§∞‡•Ä
  
  for(let i=1; i<=numCarriages; i++) {
    const carriage = document.createElement("div");
    carriage.className = "obstacle";
    carriage.textContent = 'üöÉ'; // ‡§π‡§∞ ‡§ü‡§ø‡§¨‡•ç‡§¨‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§≤‡§ó ‡§á‡§Æ‡•ã‡§ú‡•Ä
    carriage.dataset.emoji = 'üöÉ';
    carriage.style.right = `${-carriageSpacing * i}px`; // ‡§ü‡•ç‡§∞‡•á‡§® ‡§ï‡•á ‡§™‡•Ä‡§õ‡•á ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
    carriage.style.bottom = train.style.bottom;
    carriage.style.animationDuration = `${gameSpeed}s`;
    
    game.appendChild(carriage);
    
    setTimeout(() => {
      if(carriage.parentNode) carriage.remove();
    }, gameSpeed * 1000 + 500);
  }
  
  // ‡§ü‡•ç‡§∞‡•á‡§® ‡§π‡•â‡§∞‡•ç‡§® ‡§∏‡§æ‡§â‡§Ç‡§°
  if(!isMuted) audio.train.play();
}
// ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§ú‡§æ‡§Å‡§ö ‡§î‡§∞ ‡§Æ‡•à‡§ó‡•ç‡§®‡•á‡§ü‡§ø‡§ï ‡§™‡§æ‡§µ‡§∞ ‡§á‡§´‡•á‡§ï‡•ç‡§ü
setInterval(() => {
  if (isGameOver) return;
  const dinoRect = dino.getBoundingClientRect();
  
  document.querySelectorAll(".obstacle").forEach(ob => {
    const obRect = ob.getBoundingClientRect();
    const emoji = ob.dataset.emoji;
    
    // ‡§Æ‡•à‡§ó‡•ç‡§®‡•á‡§ü‡§ø‡§ï ‡§™‡§æ‡§µ‡§∞ ‡§è‡§ï‡•ç‡§ü‡§ø‡§µ ‡§π‡•à ‡§î‡§∞ ‡§Ø‡§π ‡§è‡§ï ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§Ü‡§á‡§ü‡§Æ ‡§π‡•à
    if (hasMagneticPower && leafItems.includes(emoji)) {
      // ‡§Ü‡§á‡§ü‡§Æ ‡§ï‡•ã ‡§°‡§æ‡§Ø‡§®‡§æ‡§∏‡•ã‡§∞ ‡§ï‡•Ä ‡§ì‡§∞ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç
      const dx = dinoRect.left - obRect.left;
      const dy = dinoRect.top - obRect.top;
      const distance = Math.sqrt(dx*dx + dy*dy);
      
      if (distance < 200) {
        const speedX = dx * 0.05;
        const speedY = dy * 0.05;
        ob.style.transform = `translate(${speedX}px, ${speedY}px)`;
      }
    }
    
    // ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§ö‡•á‡§ï
    if (dinoRect.left < obRect.right - 10 &&
        dinoRect.right > obRect.left + 10 &&
        dinoRect.bottom > obRect.top + 10 &&
        dinoRect.top < obRect.bottom - 10) {
      
      if (immunityItems.includes(emoji)) {
        activateImmunity();
        ob.remove();
      } else if (emoji === "üß≤") {
        activateMagneticPower();
        ob.remove();
      } else if (leafItems.includes(emoji)) {
        eaten++;
        const itemText = emoji.replace(/[^a-zA-Z‡§Ö-‡§ú‡•ç‡§û]/g, '');
        const span = document.createElement("span");
        span.title = `${itemText} ‡§ñ‡§æ‡§Ø‡§æ`;
        span.innerText = emoji;
        eatenItemsBox.appendChild(span);
        if(!isMuted) audio.eat.play();
        updateScore();
        ob.remove();
      } else if (otherItems.includes(emoji)) {
        if (hasImmunity) {
          // ‡§Ö‡§Æ‡§∞‡§§‡•ç‡§µ ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§ï‡•Å‡§õ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡§æ
          ob.remove();
        } else {
          // ‡§è‡§ï ‡§ú‡§æ‡§® ‡§ï‡§Æ ‡§π‡•ã ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à
          loseLife();
          ob.remove();
        }
      }
    }
  });
}, 20);

function gameOver() {
  isGameOver = true;
  clearInterval(obstacleInterval);
  clearInterval(scoreInterval);
  clearInterval(cloudInterval);
  clearInterval(flyInterval);
  clearInterval(fallInterval);
  clearInterval(magnetSpawnInterval);
  clearInterval(magnetEffectInterval);
  clearInterval(immunityEffectInterval);
  
  dino.textContent = "üëæ";
  restartBtn.style.display = "block";
  powerIndicator.style.display = "none";
  dino.classList.remove("magnetized");
  
  if(!isMuted) {
    audio.gameOver.play();
    audio.bgm.pause();
  }
}

// ‡§Æ‡•ç‡§Ø‡•Ç‡§ü ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
muteBtn.addEventListener('click', () => {
  isMuted = !isMuted;
  muteBtn.innerHTML = isMuted ? 'üîá' : 'üîä';
  audio.bgm[isMuted ? 'pause' : 'play']();
});

// ‡§Æ‡•à‡§ó‡•ç‡§®‡•á‡§ü ‡§ü‡•á‡§∏‡•ç‡§ü‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§≤‡§ø‡§è ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
window.forceMagnet = false;
window.spawnTestMagnet = function() {
  window.forceMagnet = true;
  spawnMagnet();
};

// ‡§¶‡§ø‡§®/‡§∞‡§æ‡§§ ‡§ö‡§ï‡•ç‡§∞
let isNight = false;
function toggleDayNight() {
  isNight = !isNight;
  document.body.style.backgroundColor = isNight ? "#001a33" : "#ddf3ff";
  sky.innerHTML = "";
  const emojis = isNight ? nightEmojis : dayEmojis;
  for(let i=0; i<4; i++) {
    const star = document.createElement("span");
    star.innerText = emojis[Math.floor(Math.random() * emojis.length)];
    star.style.position = "absolute";
    star.style.left = Math.random() * 100 + "%";
    star.style.top = Math.random() * 80 + "%";
    sky.appendChild(star);
  }
}

restartBtn.addEventListener("click", startGame);
restartBtn.addEventListener("touchstart", startGame);

// ‡§ó‡•á‡§Æ ‡§∂‡•Å‡§∞‡•Ç
toggleDayNight();
setInterval(toggleDayNight, 25000);
document.addEventListener('click', () => audio.bgm.play(), {once: true});

// ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§∏‡•Å‡§ß‡§æ‡§∞
document.addEventListener('contextmenu', e => e.preventDefault());
</script>

</body>
</html>
üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±üß±
====================================================================================

  </script>
</div>
</body>
</html>